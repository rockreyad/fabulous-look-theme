{% style %}
  .custom-product {
    background-color: #f5f5f5;
    padding: 20px;
    margin-bottom: 20px;
  }
{% endstyle %}

{% assign product = settings.selected_product %}

<div>
  <h2>{{ product.title }}</h2>
  <p>Price: {{ product.price | money }}</p>
  <form action="/cart/add" method="post">
    <input type="hidden" name="id" value="{{ product.variants.first.id }}">
    <button type="submit">Add to Cart</button>
  </form>
</div>

{% for block in section.blocks %}
  {% if block.settings.promo_text %}
    <div>{{ block.settings.promo_text | escape }}</div>
  {% endif %}
  {% unless block.settings.selected_product == blank %}
    {% assign product = all_products[settings.selected_product] %}

    {% if product %}
      {{ product.title }} - {{ product.price }}
    {% else %}
      No product, or invalid product, selected.
    {% endif %}
  {% endunless %}
  {% if block.settings.richtext %}
    <div>{{ block.settings.richtext | escape }}</div>
  {% endif %}
{% endfor %}

{% schema %}
{
  "name": "Custom Product",
  "settings": [],
  "limit": 1,
  "blocks": [
    {
      "type": "product",
      "name": "Product",
      "limit": 1,
      "settings": [
        {
          "type": "product",
          "id": "selected_product",
          "label": "Product"
        }
      ]
    },
    {
      "type": "text",
      "name": "Promotional Text",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "promo_text",
          "label": "Text",
          "default": "This is a custom product."
        }
      ]
    },
    {
      "type": "inline_richtext",
      "name": "Multicolumn",
      "limit": 4,
      "settings": [
        {
          "type": "richtext",
          "id": "richtext",
          "label": "Rich Text",
          "default": "<p>This is a custom product.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom Product",
      "blocks": [
        {
          "type": "product"
        },
        {
          "type": "text"
        },
        {
          "type": "inline_richtext"
        }
      ]
    }
  ],
  "templates": ["index"]
}
{% endschema %}
